var C=Object.defineProperty;var d=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,j=Object.prototype.propertyIsEnumerable;var y=(s,o,a)=>o in s?C(s,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[o]=a,E=(s,o)=>{for(var a in o||(o={}))P.call(o,a)&&y(s,a,o[a]);if(d)for(var a of d(o))j.call(o,a)&&y(s,a,o[a]);return s};import{v as g}from"./vueTianditu-951bb72c.js";import{b as u,C as D}from"./config-1dd32ed9.js";import{a as b}from"./useAddEvent.kooks-e46e3810.js";import{d as T,i as w,g as M,f as x,N as A,o as h,c as v,h as O,F as B,q as N,s as G,a3 as I,ao as S,u as m,a5 as _,j as $}from"./vue-65382a1b.js";function k(s){function o(p){let c={};return Object.keys(s.dataMapping).forEach(r=>{const{type:l,key:f}=s.dataMapping[r];try{if(l=="json|LngLat"){const{lng:t,lat:n}=s.dataMapping[r];let e=[];JSON.parse(p[f]).forEach(i=>{i[t]&&i[n]&&e.push([i[t],i[n]])}),c[r]=e}else if(l=="json|LngLatArray")c[r]=JSON.parse(p[f]);else if(l=="array|LngLat"){const{lng:t,lat:n}=s.dataMapping[r];let e=[];p[f].forEach(i=>{i[t]&&i[n]&&e.push([i[t],i[n]])}),c[r]=e}else if(l=="array|LngLatArray")Array.isArray(p[f])?c[r]=p[f]:window.$message.error("数据映射格式不匹配,请检查数据映射配置");else if(l=="LngLat"){const{lng:t,lat:n}=s.dataMapping[r];p[t]&&p[n]&&(c[r]=[p[t],p[n]])}else c[r]=p[f]}catch(t){window.$message.error("数据映射格式不匹配,请检查数据映射配置"),console.error("数据映射格式不匹配"),console.error(t)}}),c}function a(p,c){let r=o(p);Object.keys(r).forEach(l=>{c.hasOwnProperty(l)&&(c[l]=r[l])})}return{getDataMapping:o,setDataMappingOptions:a}}const q={style:{display:"none"}},F={ref:"content"},R=T({name:"coverGroup",components:{Marker:g.TdtMarker,Circle:g.TdtCircle,Polygon:g.TdtPolygon,Polyline:g.TdtPolyline},__name:"index",props:{config:{type:Object,required:!0}},setup(s){const o=s,a=w("mapIns"),p=M(()=>o.config.type||null),{rootConfig:c,getEvents:r}=b(o.config,D),{setDataMappingOptions:l}=k(o.config),f=M(()=>{let t=[];return o.config.data.forEach(n=>{let e=E({},o.config.options);Object.keys(o.config.options).forEach(i=>{Object.keys(n).includes(i)&&(e[i]=n[i])}),l(n,e),e.extData=n,[u.Marker].includes(o.config.type)?e.position&&t.push(e):o.config.type==u.Circle?e.center&&t.push(e):[u.Polyline,u.Polygon].includes(o.config.type)?e.path&&t.push(e):t.push(e)}),t});return x(f,t=>{A(()=>{let n=[];[u.Marker].includes(o.config.type)?t.forEach(e=>{e.position&&n.push(e.position)}):o.config.type==u.Circle?t.forEach(e=>{e.center&&n.push(e.center)}):[u.Polyline,u.Polygon].includes(o.config.type)&&t.forEach(e=>{e.path&&n.push(...e.path)}),a.setCoverGroupViewport(n)})}),(t,n)=>(h(),v("div",q,[O("template",null,[(h(!0),v(B,null,N(m(f),(e,i)=>(h(),G(_(m(p)),I({key:i},e,S(m(r))),null,16))),128))]),O("div",F,[$(t.$slots,"default")],512)]))}});export{R as _};
