var F=(b,f,p)=>new Promise((d,v)=>{var h=i=>{try{m(p.next(i))}catch(_){v(_)}},r=i=>{try{m(p.throw(i))}catch(_){v(_)}},m=i=>i.done?d(i.value):Promise.resolve(i.value).then(h,r);m((p=p.apply(b,f)).next())});import{u as A,ao as G}from"./index-4e626338.js";import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css                *//* empty css                  *//* empty css                 *//* empty css                */import{d as M,aI as V,i as j,a7 as T,r as x,g as P,e as K,$ as L,al as O,o as J,c as Q,h as I,a as e,w as a,u as l,a6 as y,F as W,ah as R}from"./vue-65382a1b.js";import{i as X}from"./icon-24f36b03.js";import{c as Y}from"./http-0d114cdb.js";import"./el-collapse-item-4ed993c7.js";/* empty css                 *//* empty css                                                                    */import{_ as q}from"./SettingItemBox-ce5066ee.js";/* empty css                        *//* empty css               *//* empty css                     *//* empty css                        *//* empty css                     *//* empty css                        *//* empty css                  *//* empty css                   *//* empty css                                                                  *//* empty css                    *//* empty css                  *//* empty css                        */import{u as Z}from"./chartEditStore-8641b951.js";import"./vuedraggable-26823587.js";import tt from"./index-6bee5765.js";import et from"./index-e62ff3d0.js";import{w as ot,x as at,k as rt,p as nt,C as it}from"./elementPlus-07602b2b.js";import{_ as lt}from"./xgplayerVue-c27b6911.js";import"./vueRepl-a238c739.js";import"./lodash-f91682a1.js";import"./vuema-115cb50e.js";import"./Close-095524a6.js";import"./axios-ba46900f.js";import"./axios-e76ab20a.js";import"./index-55ccac47.js";import"./echarts-676dbcd6.js";import"./plugin-68db7aa1.js";import"./index-806da9dd.js";/* empty css                   */import"./noData-2e4135e0.js";import"./index-04a82e01.js";/* empty css                         */import"./useTargetData.hook-7e83673b.js";/* empty css                */import"./el-collapse-transition-4ed993c7.js";import"./index.d-4993f78d.js";/* empty css                    *//* empty css                 *//* empty css                    *//* empty css                        */import"./index.vue_vue_type_style_index_0_lang-bfc00404.js";import"./index-4b49ec82.js";import"./SettingItem-0e9c370f.js";import"./index.vue_vue_type_script_setup_true_lang-56c8ff75.js";/* empty css                  *//* empty css                 */import"./EditorWorker.vue_vue_type_script_setup_true_lang-44860150.js";import"./editorWorker-7e4b3ef6.js";import"./index-bea6e953.js";import"./index-bf1882c4.js";import"./index-7fe425bd.js";/* empty css                                                              *//* empty css                                                                  */import"./index-4346e8ac.js";import"./hCode-f0cdea69.js";import"./highlight-87778b4e.js";import"./fileTypeEnum-eae25d97.js";/* empty css                    */import"./index-1b5afad1.js";import"./useFile.hooks-6b86f602.js";const st={class:"chart-data-pond"},pt={class:"kh-absolute-center"},mt=M({__name:"index",setup(b){V(o=>({74435690:H.value}));const f=A(),{HelpOutlineIcon:p,FlashIcon:d,PulseIcon:v,FishIcon:h}=X.ionicons5,r=j("targetData"),m=Z(),{requestDataPond:i,requestInterval:_,requestIntervalUnit:ut}=T(m.getRequestGlobalConfig),u=x(!1),g=x(!1),D=x(!1);let E=0,w;const S=P(()=>{const o=r.value.request.requestDataPondId;return o?i.value.filter(n=>o===n.dataPondId)[0]:void 0}),H=P(()=>f.getAppTheme),B=()=>{g.value=!0},C=()=>F(this,null,function*(){var o;if(!((o=r.value)!=null&&o.request)){window.$message.warning("请选择一个公共接口！");return}u.value=!0;try{const t=yield Y(R(r.value.request),R(m.getRequestGlobalConfig));if(u.value=!1,console.log(t),t){!(t!=null&&t.data)&&!r.value.filter&&window.$message.warning("您的数据不符合默认格式，请配置过滤器！");let{filter:n,filterNode:c}=r.value;!n&&c&&(n="return data."+c),r.value.data=G(t==null?void 0:t.data,t,n),N(r.value.data),D.value=!0;return}window.$message.warning("数据异常，请检查参数！")}catch(t){u.value=!1,window.$message.warning("数据异常，请检查参数！")}});function N(o){Array.isArray(o)&&o[0]&&(r.value.dataKeyList=Object.keys(o[0]).map(t=>({key:t,type:typeof o[0][t]})))}return K(()=>{var t;const o=(t=r.value)==null?void 0:t.filter;w!==o&&E&&(w=o,C()),E++}),L(()=>{w=null}),(o,t)=>{const n=ot,c=at,k=rt,U=nt,$=it,z=O("go-skeleton");return J(),Q(W,null,[I("div",st,[e(U,{class:"el-card-shallow"},{default:a(()=>[e(l(q),{name:"请求名称",alone:!0},{default:a(()=>{var s;return[e(c,{size:"small",placeholder:((s=S.value)==null?void 0:s.dataPondName)||"暂无",disabled:!0},{prefix:a(()=>[e(n,{component:l(h)},null,8,["component"])]),_:1},8,["placeholder"])]}),_:1}),e(l(q),{name:"接口地址",alone:!0},{default:a(()=>{var s;return[e(c,{size:"small",placeholder:((s=S.value)==null?void 0:s.dataPondRequestConfig.requestUrl)||"暂无",disabled:!0},{prefix:a(()=>[e(n,{component:l(d)},null,8,["component"])]),_:1},8,["placeholder"])]}),_:1}),I("div",{class:"edit-text",onClick:B},[I("div",pt,[e(k,{type:"primary"},{default:a(()=>[y("编辑配置")]),_:1})])])]),_:1})]),e(l(q),{alone:!0},{name:a(()=>[y(" 测试 "),e($,{trigger:"hover",content:"默认赋值给 dataset 字段"},{default:a(()=>[e(n,{size:"21",depth:3},{default:a(()=>[e(l(p))]),_:1})]),_:1})]),default:a(()=>[e(k,{type:"primary",ghost:"",onClick:C},{icon:a(()=>[e(n,null,{default:a(()=>[e(l(d))]),_:1})]),default:a(()=>[y(" 发送请求 ")]),_:1})]),_:1}),e(l(et),{show:D.value&&!u.value,ajax:!0},null,8,["show"]),e(z,{load:u.value,repeat:3},null,8,["load"]),e(l(tt),{modelShow:g.value,"onUpdate:modelShow":t[0]||(t[0]=s=>g.value=s),onSendHandle:C},null,8,["modelShow"])],64)}}});const He=lt(mt,[["__scopeId","data-v-6cc5a0e7"]]);export{He as default};
