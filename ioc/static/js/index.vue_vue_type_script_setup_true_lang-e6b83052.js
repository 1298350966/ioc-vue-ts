import{C as A}from"./config-d82a35a6.js";import{a as C}from"./useAddEvent.kooks-e46e3810.js";import"./index-4e626338.js";import{u as v}from"./useChartDataFetch.hook-495a5af9.js";import"./axios-ba46900f.js";import"./echarts-676dbcd6.js";import{l as k}from"./lodash-f91682a1.js";import{z as O,A as D,q as b,B as j,C as w,D as P}from"./vuema-115cb50e.js";import{d as G,i as B,r as M,g as E,f as S,A as q,o as m,c as d,h as y,F as x,q as I,s as _,a3 as z,ao as F,u as h,a5 as N,j as $}from"./vue-65382a1b.js";function H(f){function e(t){let s={};return Object.keys(f.dataMapping).forEach(r=>{const{type:p,key:c}=f.dataMapping[r];try{if(p=="json|LngLat"){const{lng:i,lat:l}=f.dataMapping[r];let o=[];JSON.parse(t[c]).forEach(n=>{n[i]&&n[l]&&o.push([n[i],n[l]])}),s[r]=o}else if(p=="json|LngLatArray")s[r]=JSON.parse(t[c]);else if(p=="array|LngLat"){const{lng:i,lat:l}=f.dataMapping[r];let o=[];t[c].forEach(n=>{n[i]&&n[l]&&o.push([n[i],n[l]])}),s[r]=o}else if(p=="array|LngLatArray")Array.isArray(t[c])?s[r]=t[c]:window.$message.error("数据映射格式不匹配,请检查数据映射配置");else if(p=="LngLat"){const{lng:i,lat:l}=f.dataMapping[r];t[i]&&t[l]&&(s[r]=[t[i],t[l]])}else s[r]=t[c]}catch(i){window.$message.error("数据映射格式不匹配,请检查数据映射配置"),console.error("数据映射格式不匹配"),console.error(i)}}),s}function g(t,s){let r=e(t);Object.keys(r).forEach(p=>{s.hasOwnProperty(p)&&(s[p]=r[p])})}return{getDataMapping:e,setDataMappingOptions:g}}const J={style:{display:"none"}},L={ref:"content"},Z=G({name:"coverGroup",components:{Marker:O,CircleMarker:D,Polygon:b,Polyline:j,LabelMarker:w,ElasticMarker:P},__name:"index",props:{config:{required:!0,type:Object}},setup(f){const e=f,g=B("map"),{setDataMappingOptions:t}=H(e.config),s=M(null);M(!1);const r=E(()=>e.config.type||null),p=E(()=>{let o=[];return e.config.data.forEach(n=>{let a=k.cloneDeep(e.config.options);Object.keys(e.config.options).forEach(u=>{Object.keys(n).includes(u)&&(a[u]=n[u])}),t(n,a),a.extData=n,["Marker","LabelMarker","ElasticMarker"].includes(e.config.type)?(e.config.type=="Marker"&&(a.icon=new window.AMap.Icon({imageSize:a.icon.imageSize,image:a.icon.image})),a.position&&o.push(a)):e.config.type=="CircleMarker"?a.center&&o.push(a):["Polyline","Polygon"].includes(e.config.type)?a.path&&o.push(a):o.push(a)}),o}),{rootConfig:c,getEvents:i}=C(e.config,A);c&&v(e.config,c.requestGlobalConfig,o=>{console.log(o)}),S(()=>e.config.data,()=>{});function l(o){}return q(()=>{g.addCoverGroup(e.config.id,s)}),(o,n)=>(m(),d("div",J,[y("template",null,[(m(!0),d(x,null,I(h(p),(a,u)=>(m(),d("div",{key:u},[(m(),_(N(h(r)),z({ref_for:!0,ref_key:"CoverGroupRef",ref:s},a,F(h(i)),{onInit:l}),null,16))]))),128))]),y("div",L,[$(o.$slots,"default")],512)]))}});export{Z as _};
