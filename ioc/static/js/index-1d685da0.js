var X=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var H=(t,o,n)=>o in t?X(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,x=(t,o)=>{for(var n in o||(o={}))ee.call(o,n)&&H(t,n,o[n]);if($)for(var n of $(o))te.call(o,n)&&H(t,n,o[n]);return t},b=(t,o)=>Y(t,Z(o));import{_ as U}from"./index-806da9dd.js";import{g as oe,R as N}from"./index-4e626338.js";/* empty css                 *//* empty css                  *//* empty css                *//* empty css                */import{n as ae}from"./noData-2e4135e0.js";import se from"./index-b4851b4c.js";/* empty css               *//* empty css                *//* empty css                     */import"./el-tooltip-4ed993c7.js";/* empty css                  */import"./el-collapse-transition-4ed993c7.js";/* empty css                 *//* empty css                        *//* empty css                     *//* empty css                        */import"./el-collapse-item-4ed993c7.js";/* empty css                                                                    */import"./SettingItemBox-ce5066ee.js";/* empty css                        *//* empty css                  *//* empty css                   */import{g as j}from"./plugin-68db7aa1.js";import{i as ne}from"./icon-24f36b03.js";/* empty css                                                                  *//* empty css                    *//* empty css                  *//* empty css                        */import"./chartEditStore-8641b951.js";import"./vuedraggable-26823587.js";import{u as le}from"./useTargetData.hook-7e83673b.js";import"./index.d-4993f78d.js";/* empty css                    *//* empty css                 *//* empty css                    *//* empty css                        */import"./index.vue_vue_type_style_index_0_lang-9b48fdd8.js";import re from"./index-6d27ca02.js";/* empty css                  *//* empty css                 */import"./EditorWorker.vue_vue_type_script_setup_true_lang-44860150.js";import"./index-caf6ae63.js";import"./index-bf1882c4.js";import de from"./index-62bfb4b2.js";/* empty css                                                              */import{i as ie,d as ue,x as me,n as G,k as O,p as pe,w as ce}from"./elementPlus-07602b2b.js";import{d as z,r as g,f as F,o as v,s as k,w as a,a as s,a6 as D,c as V,h as I,u as c,i as fe,a7 as _e,g as T,N as ge,x as ve,F as we,ah as B,G as he,H as qe}from"./vue-65382a1b.js";/* empty css                                                                  */import{_ as L}from"./xgplayerVue-c27b6911.js";import Pe from"./index-e215ccae.js";import{t as De}from"./index-55ccac47.js";import{l as Ie}from"./lodash-f91682a1.js";/* empty css                   */import"./vueRepl-a238c739.js";import"./vuema-115cb50e.js";/* empty css                         */import"./Close-095524a6.js";import"./SettingItem-0e9c370f.js";import"./index.vue_vue_type_script_setup_true_lang-22cae6b4.js";import"./echarts-676dbcd6.js";import"./editorWorker-7e4b3ef6.js";import"./hCode-f0cdea69.js";import"./highlight-87778b4e.js";const ye={class:"go-pr-3"},Ce={key:1},Se=z({__name:"pondIndex",props:{modelShow:Boolean,targetDataRequest:Object},emits:["update:modelShow","editSaveHandle"],setup(t,{emit:o}){const n=t;g();const y=g(),f=g(!1);F(()=>n.modelShow,d=>{f.value=d});const _=()=>{o("update:modelShow",!1)},m=()=>{var d,u;if(!((d=n.targetDataRequest)!=null&&d.dataPondName)){window.$message.warning("请在左下角输入名称！"),(u=y.value)==null||u.focus();return}j({message:"保存内容将同步修改所有使用此接口的组件, 是否继续?",isMaskClosable:!0,transformOrigin:"center",onPositiveCallback:()=>{o("update:modelShow",!1),o("editSaveHandle",n.targetDataRequest)}})};return(d,u)=>{const q=ie,w=ue,h=me,i=G,P=O,E=U;return v(),k(E,{title:"接口设置",class:"go-chart-data-request",modelValue:f.value,"onUpdate:modelValue":u[1]||(u[1]=p=>f.value=p),onClose:_},{footer:a(()=>[s(i,{justify:"space-between",style:{width:"100%","justify-content":"space-between"}},{default:a(()=>[t.targetDataRequest?(v(),k(i,{key:0},{default:a(()=>[s(w,{type:"success",size:"large"},{default:a(()=>[D("名称：")]),_:1}),s(h,{modelValue:t.targetDataRequest.dataPondName,"onUpdate:modelValue":u[0]||(u[0]=p=>t.targetDataRequest.dataPondName=p),ref_key:"inputInstRef",ref:y,type:"text",size:"small",autofocus:!0,clearable:!0,minlength:1,maxlength:16,placeholder:"请输入名称"},null,8,["modelValue"])]),_:1})):(v(),V("span",Ce)),s(i,null,{default:a(()=>[s(P,{onClick:_},{default:a(()=>[D("取消")]),_:1}),s(P,{type:"primary",onClick:m},{default:a(()=>[D("保存")]),_:1})]),_:1})]),_:1})]),default:a(()=>[s(q,{height:"640px","wrap-style":"padding:20px;"},{default:a(()=>{var p;return[I("div",ye,[I("div",null,[s(c(re)),s(c(de),{"target-data-request":(p=t.targetDataRequest)==null?void 0:p.dataPondRequestConfig},null,8,["target-data-request"])])])]}),_:1})]),_:1},8,["modelValue"])}}}),Re=L(Se,[["__scopeId","data-v-33eff72a"]]),xe=t=>(he("data-v-f631997a"),t=t(),qe(),t),be={class:"pond-content"},ke={key:1,class:"no-data go-flex-center"},Ee=["src"],Ve=xe(()=>I("span",null,"暂未选择公共接口",-1)),$e=z({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow","sendHandle"],setup(t,{emit:o}){const n=t,{PencilIcon:y}=ne.ionicons5,{chartEditStore:f}=le(),_=fe("targetData"),{requestDataPond:m}=_e(f.getRequestGlobalConfig),d=g(!1),u=T({get(){return n.modelShow},set(e){o("update:modelShow",e)}}),q=g(!1),w=g(!1),h=g(),i=T(()=>{var r,C;const e=(C=(r=_==null?void 0:_.value)==null?void 0:r.request)==null?void 0:C.requestDataPondId;return e?m.value.filter(S=>e===S.dataPondId)[0]:void 0});F(()=>i.value,e=>{q.value=!0,h.value=e,ge(()=>{q.value=!1})},{immediate:!0});const P=(e=!1)=>{w.value=!!e,d.value=!0},E=()=>{const e=oe();h.value={dataPondId:e,dataPondName:e,dataPondRequestConfig:Ie.cloneDeep(b(x({},De),{requestDataType:N.Pond}))},P()},p=e=>{w.value?M(e):A(e),w.value=!1,d.value=!1},M=e=>{try{const l=m.value.findIndex(r=>r.dataPondId===e.dataPondId);l!==-1?(m.value.splice(l,1,e),f.getComponentList.forEach(r=>{r.request.requestDataType===N.Pond&&r.request.requestDataPondId===e.dataPondId&&(r.request=b(x({},B(e.dataPondRequestConfig)),{requestDataPondId:e.dataPondId}))}),window.$message.success("保存成功！")):window.$message.error("编辑失败，请稍后重试！")}catch(l){window.$message.error("编辑失败，请稍后重试！")}},A=e=>{try{h.value?(m.value.unshift(e),window.$message.success("创建成功!")):window.$message.error("创建失败，请稍后重试!")}catch(l){window.$message.error("创建失败，请稍后重试!")}},J=e=>{j({message:"删除数据后，需手动处理使用改接口的组件，是否继续？",isMaskClosable:!0,transformOrigin:"center",onPositiveCallback:()=>{const l=m.value.findIndex(r=>r.dataPondId===e.dataPondId);l!==-1?(m.value.splice(l,1),window.$message.success("删除成功!")):window.$message.error("删除失败，请稍后重试！")}})},K=()=>{i.value&&(_.value.request=b(x({},B(i.value.dataPondRequestConfig)),{requestDataPondId:i.value.dataPondId})),o("update:modelShow",!1),o("sendHandle")};return(e,l)=>{const r=pe,C=ce,S=O,Q=G,W=U;return v(),V(we,null,[s(W,{title:"公共接口配置",class:"go-chart-data-pond-control",modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=R=>u.value=R)},{footer:a(()=>[s(Q,{justify:"space-between"},{default:a(()=>[s(S,{type:"info",secondary:"",disabled:!i.value,onClick:l[0]||(l[0]=R=>P(!0))},{icon:a(()=>[s(C,null,{default:a(()=>[s(c(y))]),_:1})]),default:a(()=>[D(" 编辑内容 ")]),_:1},8,["disabled"]),s(S,{type:"primary",onClick:K},{default:a(()=>[D("保存 & 发送请求")]),_:1})]),_:1})]),default:a(()=>[s(r,{style:{height:"650px"}},{default:a(()=>[I("div",be,[i.value&&!q.value?(v(),k(c(Pe),{key:0,targetData:i.value,globalData:c(f).getRequestGlobalConfig},null,8,["targetData","globalData"])):(v(),V("div",ke,[I("img",{src:c(ae),alt:"暂无数据"},null,8,Ee),Ve])),s(c(se),{onCreatePond:E,onDeletePond:J})])]),_:1})]),_:1},8,["modelValue"]),d.value?(v(),k(c(Re),{key:0,modelShow:d.value,"onUpdate:modelShow":l[2]||(l[2]=R=>d.value=R),targetDataRequest:h.value,isEdit:w.value,onEditSaveHandle:p},null,8,["modelShow","targetDataRequest","isEdit"])):ve("",!0)],64)}}});const At=L($e,[["__scopeId","data-v-f631997a"]]);export{At as default};
