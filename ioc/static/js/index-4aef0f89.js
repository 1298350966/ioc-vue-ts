var V=Object.defineProperty,J=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var R=(a,e,r)=>e in a?V(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r,b=(a,e)=>{for(var r in e||(e={}))Q.call(e,r)&&R(a,r,e[r]);if(q)for(var r of q(e))W.call(e,r)&&R(a,r,e[r]);return a},F=(a,e)=>J(a,K(e));var z=(a,e,r)=>new Promise((C,x)=>{var H=c=>{try{p(r.next(c))}catch(v){x(v)}},y=c=>{try{p(r.throw(c))}catch(v){x(v)}},p=c=>c.done?C(c.value):Promise.resolve(c.value).then(H,y);p((r=r.apply(a,e)).next())});import"./index-4e626338.js";import{u as X}from"./useChartDataFetch.hook-495a5af9.js";import"./axios-ba46900f.js";import"./echarts-676dbcd6.js";import"./lodash-f91682a1.js";import{d as Y,a7 as j,i as Z,b as tt,f as k,B as et,o as I,c as T,F as ot,q as nt,n as d,h as g,u,l as D,G as at,H as rt}from"./vue-65382a1b.js";import{_ as st}from"./xgplayerVue-c27b6911.js";import"./elementPlus-07602b2b.js";import"./vuema-115cb50e.js";import"./vueRepl-a238c739.js";import"./http-0d114cdb.js";import"./axios-e76ab20a.js";const it=a=>(at("data-v-66938c77"),a=a(),rt(),a),ct={class:"ranking-info"},lt=["innerHTML"],ut=it(()=>g("div",{class:"shine"},null,-1)),mt=[ut],dt=Y({__name:"index",props:{chartConfig:{type:Object,required:!0}},setup(a){const e=a,{w:r,h:C}=j(e.chartConfig.attr),{rowNum:x,unit:H,color:y,textColor:p,borderColor:c,indexFontSize:v,leftFontSize:G,rightFontSize:P}=j(e.chartConfig.option),E=Z("rootConfig"),t=tt({mergedConfig:e.chartConfig.option,rowsData:[],rows:[{scroll:0,ranking:1,name:"",value:"",percent:0}],heights:[0],animationIndex:0,animationHandler:0,updater:0,avgHeight:0}),O=()=>{let{dataset:o,rowNum:m,sort:n}=t.mergedConfig;n&&o.sort(({value:s},{value:i})=>{if(s>i)return-1;if(s<i)return 1;if(s===i)return 0});const l=o.map(({value:s})=>s),w=Math.min(...l)||0,_=Math.abs(w),$=(Math.max(...l)||0)+_;o=o.map((s,i)=>F(b({},s),{ranking:i+1,percent:(s.value+_)/$*100}));const h=o.length;h>m&&h<2*m&&(o=[...o,...o]),o=o.map((s,i)=>F(b({},s),{scroll:i})),t.rowsData=o,t.rows=o},U=(o=!1)=>{const{rowNum:m,dataset:n}=t.mergedConfig,l=C.value/m;t.avgHeight=l,o||(t.heights=new Array(n.length).fill(l))},A=(o=!1)=>z(this,null,function*(){let{avgHeight:m,animationIndex:n,mergedConfig:l,rowsData:w,updater:_}=t;const{waitTime:N,carousel:$,rowNum:h}=l,s=w.length;if(h>=s||o&&(yield new Promise(S=>setTimeout(S,N)),_!==t.updater))return;const i=$==="single"?1:h;let M=w.slice(n);if(M.push(...w.slice(0,n)),t.rows=M.slice(0,h+1),t.heights=new Array(s).fill(m),yield new Promise(S=>setTimeout(S,300)),_!==t.updater)return;t.heights.splice(0,i,...new Array(i).fill(0)),n+=i;const B=n-s;B>=0&&(n=B),t.animationIndex=n,t.animationHandler=setTimeout(A,N*1e3-300)}),L=()=>{t.updater=(t.updater+1)%999999,t.animationHandler&&clearTimeout(t.animationHandler)},f=()=>z(this,null,function*(){t.mergedConfig&&(L(),O(),U(!0),A(!0))});return f(),k(()=>r.value,()=>{f()}),k(()=>C.value,()=>{f()}),k(()=>x.value,()=>{f()}),k(()=>e.chartConfig.option.dataset,()=>{f()},{deep:!1}),X(e.chartConfig,E.requestGlobalConfig,o=>{e.chartConfig.option.dataset=o,f()}),et(()=>{L()}),(o,m)=>(I(),T("div",{class:"go-tables-rank",style:d(`color: ${u(p)}`)},[(I(!0),T(ot,null,nt(t.rows,(n,l)=>(I(),T("div",{class:"row-item",key:n.toString()+n.scroll,style:d(`height: ${t.heights[l]}px;`)},[g("div",ct,[g("div",{class:"rank",style:d(`color: ${u(y)};font-size: ${u(v)}px`)},"No."+D(n.ranking),5),g("div",{class:"info-name",style:d(`font-size: ${u(G)}px`),innerHTML:n.name},null,12,lt),g("div",{class:"ranking-value",style:d(`color: ${u(p)};font-size: ${u(P)}px`)},D(t.mergedConfig.valueFormatter?t.mergedConfig.valueFormatter(n):n.value)+" "+D(u(H)),5)]),g("div",{class:"ranking-column",style:d(`border-color: ${u(c)}`)},[g("div",{class:"inside-column",style:d(`width: ${n.percent}%;background-color: ${u(y)}`)},mt,4)],4)],4))),128))],4))}});const $t=st(dt,[["__scopeId","data-v-66938c77"]]);export{$t as default};
