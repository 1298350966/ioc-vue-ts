import{R as J,am as K}from"./index-4e626338.js";/* empty css                         *//* empty css                *//* empty css                     */import{_ as W}from"./hCode-f0cdea69.js";import"./el-tooltip-4ed993c7.js";/* empty css                  */import"./fileTypeEnum-eae25d97.js";/* empty css                    *//* empty css                  *//* empty css                *//* empty css                 */import{_ as X}from"./SettingItem-0e9c370f.js";/* empty css                 */import{d as B,g as U,o as p,s as f,w as t,a as e,a6 as k,l as T,c as S,u as l,i as Y,a7 as Z,r as z,f as ee,al as te,y as ae,x as I,z as oe,a0 as le,G as ne,H as se,h as ie}from"./vue-65382a1b.js";import{i as pe}from"./icon-24f36b03.js";import re from"./index-0771e20d.js";/* empty css                 *//* empty css                    *//* empty css               *//* empty css                        *//* empty css                     *//* empty css                        */import{$ as me,ap as ue,x as N,C as w,_ as de,a5 as ce,n as _e,w as fe,k as ge,ab as ye,i as ve,p as he,a4 as be}from"./elementPlus-07602b2b.js";import{_ as R}from"./xgplayerVue-c27b6911.js";import{T as D,D as v}from"./index.d-4993f78d.js";import{u as Ve}from"./useFile.hooks-6b86f602.js";import"./vueRepl-a238c739.js";import"./lodash-f91682a1.js";import"./vuema-115cb50e.js";import"./highlight-87778b4e.js";/* empty css                                                                    */import"./Close-095524a6.js";import"./index-806da9dd.js";/* empty css                   *//* empty css                *//* empty css                    */import"./el-collapse-item-4ed993c7.js";/* empty css                   */import"./EditorWorker.vue_vue_type_script_setup_true_lang-44860150.js";import"./editorWorker-7e4b3ef6.js";import"./plugin-68db7aa1.js";import"./chartEditStore-8641b951.js";import"./index-55ccac47.js";import"./echarts-676dbcd6.js";const Ee={key:1},Se={key:0,class:"kh-flex-between"},De={key:1},Ue=B({__name:"mapDataMapping",props:{targetData:{}},setup(r){const n=r,h=U(()=>Object.keys(n.targetData.dataMapping).map(g=>n.targetData.dataMapping[g]));return(g,x)=>{const m=me,_=ue,u=N,c=w,b=de;return p(),f(b,{size:"small",border:"",striped:"",data:l(h)},{default:t(()=>[e(m,{prop:"label",label:"名称",align:"center",width:"60"},{default:t(({row:o})=>[k(T(o.label),1)]),_:1}),e(m,{prop:"type",label:"类型",align:"center"},{default:t(({row:o})=>[o.typeOptions?(p(),f(_,{key:0,modelValue:o.type,"onUpdate:modelValue":i=>o.type=i,size:"small",options:o.typeOptions},null,8,["modelValue","onUpdate:modelValue","options"])):(p(),S("span",Ee,T(o.type),1))]),_:1}),e(m,{prop:"key",label:"字段",align:"center"},{default:t(({row:o})=>[o.type=="LngLat"?(p(),S("div",Se,[e(c,{content:"经度"},{default:t(()=>[e(u,{class:"mr-1",size:"small",modelValue:o.lng,"onUpdate:modelValue":i=>o.lng=i},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(c,{content:"纬度"},{default:t(()=>[e(u,{size:"small",modelValue:o.lat,"onUpdate:modelValue":i=>o.lat=i},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)])):(p(),S("div",De,[e(u,{size:"small",modelValue:o.key,"onUpdate:modelValue":i=>o.key=i},null,8,["modelValue","onUpdate:modelValue"])]))]),_:1})]),_:1},8,["data"])}}});const ke=R(Ue,[["__scopeId","data-v-c1c64604"]]),xe=r=>(ne("data-v-157d7ff1"),r=r(),se(),r),Ce=xe(()=>ie("p",null,"过滤器默认处理接口返回值的「data」字段",-1)),Te=B({__name:"index",props:{show:{type:Boolean,required:!1},ajax:{type:Boolean,required:!0}},setup(r){const n=Y("targetData"),{DocumentAddIcon:h,DocumentDownloadIcon:g}=pe.carbon,{dimensions:x}=Z(n.value.dataset),m=U(()=>{var a,s;return((a=n.value)==null?void 0:a.data)||((s=n.value)==null?void 0:s.dataset)||"此组件无数据源"}),_=z(),u=z(!1),{uploadFileListRef:c,customRequest:b,beforeUpload:o,download:i}=Ve(n),q=U(()=>n.value.request.requestDataType!==J.STATIC),A=a=>{let s=v.SUCCESS;for(let d=0;d<m.value.length;d++)if(m.value[d][a]===void 0)return s=v.FAILURE,s;return v.SUCCESS},L=()=>{try{return x.value.map((a,s)=>s===0?{field:"通用标识",mapping:a,result:v.NULL}:{field:`数据项-${s}`,mapping:a,result:A(a)})}catch(a){return[]}};return ee(()=>{var a;return(a=n.value)==null?void 0:a.data},a=>{a?_.value=L():a!=null?_.value=null:u.value=!0,K(a)&&(_.value=null)},{immediate:!0}),(a,s)=>{const d=ce,M=N,j=X,y=_e,V=fe,C=ge,F=ye,O=te("QuestionFilled"),$=w,H=W,G=ve,P=he,Q=be;return p(),f(Q,{style:{"padding-left":"10px"}},{default:t(()=>[e(d,{color:"#2a2a2b",size:"large",hollow:!0,type:"info",timestamp:l(D).MAPPING,placement:"top"},{default:t(()=>[e(ke,{targetData:l(n)},null,8,["targetData"])]),_:1},8,["timestamp"]),ae(e(d,{type:"warning",color:"#2a2a2b",size:"large",hollow:!0,timestamp:l(D).FILTER,placement:"top"},{default:t(()=>[l(n).filter?I("",!0):(p(),f(j,{key:0,name:"过滤节点(添加过滤器配置过滤节点失效)"},{default:t(()=>[e(M,{style:{width:"100%"},modelValue:l(n).filterNode,"onUpdate:modelValue":s[0]||(s[0]=E=>l(n).filterNode=E)},null,8,["modelValue"])]),_:1})),e(y,{direction:"vertical",alignment:"start"},{default:t(()=>[Ce,e(l(re))]),_:1})]),_:1},8,["timestamp"]),[[oe,q.value]]),e(d,{type:"success",color:"#2a2a2b",size:"large",hollow:!0,timestamp:l(D).CONTENT,placement:"top"},{default:t(()=>[e(y,{direction:"horizontal","fill-ratio":100,fill:"",style:{width:"100%"}},{default:t(()=>[e(y,null,{default:t(()=>[e(F,{"file-list":l(c),"onUpdate:fileList":s[1]||(s[1]=E=>le(c)?c.value=E:null),"show-file-list":!1,"http-request":l(b),onBeforeUpload:l(o)},{default:t(()=>[e(y,null,{default:t(()=>[r.ajax?I("",!0):(p(),f(C,{key:0,class:"sourceBtn-item",disabled:u.value},{icon:t(()=>[e(V,{size:14},{default:t(()=>[e(l(h))]),_:1})]),default:t(()=>[k(" 导入（json / txt） ")]),_:1},8,["disabled"]))]),_:1})]),_:1},8,["file-list","http-request","onBeforeUpload"]),e(C,{class:"sourceBtn-item",disabled:u.value,onClick:l(i)},{icon:t(()=>[e(V,{size:14},{default:t(()=>[e(l(g))]),_:1})]),default:t(()=>[k(" 下载 ")]),_:1},8,["disabled","onClick"]),e($,{content:"点击【下载】查看完整数据"},{default:t(()=>[e(V,{size:16},{default:t(()=>[e(O)]),_:1})]),_:1})]),_:1}),e(P,{shadow:"never",style:{padding:"0"}},{default:t(()=>[e(G,{height:"400px"},{default:t(()=>[e(H,{code:JSON.stringify(m.value,null,2),language:"json"},null,8,["code"])]),_:1})]),_:1})]),_:1})]),_:1},8,["timestamp"])]),_:1})}}});const Vt=R(Te,[["__scopeId","data-v-157d7ff1"]]);export{Vt as default};
