var X=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var $=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var H=(t,o,n)=>o in t?X(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,R=(t,o)=>{for(var n in o||(o={}))ee.call(o,n)&&H(t,n,o[n]);if($)for(var n of $(o))te.call(o,n)&&H(t,n,o[n]);return t},b=(t,o)=>Y(t,Z(o));import{_ as U}from"./index-806da9dd.js";import{g as oe,R as N}from"./index-4e626338.js";/* empty css                 *//* empty css                  *//* empty css                *//* empty css                */import{n as ae}from"./noData-2e4135e0.js";import se from"./index-da5777c2.js";/* empty css               *//* empty css                *//* empty css                     */import"./el-tooltip-4ed993c7.js";/* empty css                  */import"./el-collapse-transition-4ed993c7.js";/* empty css                 *//* empty css                        *//* empty css                     *//* empty css                        */import"./el-collapse-item-4ed993c7.js";/* empty css                                                                    */import"./SettingItemBox-ce5066ee.js";/* empty css                        *//* empty css                  *//* empty css                   */import{g as j}from"./plugin-68db7aa1.js";import{i as ne}from"./icon-24f36b03.js";/* empty css                                                                  *//* empty css                    *//* empty css                  *//* empty css                        */import"./chartEditStore-8641b951.js";import"./vuedraggable-26823587.js";import{u as le}from"./useTargetData.hook-7e83673b.js";import"./index.d-4993f78d.js";/* empty css                    *//* empty css                 *//* empty css                    *//* empty css                        */import"./index.vue_vue_type_style_index_0_lang-8a0c194b.js";import re from"./index-c7e5bde4.js";/* empty css                  *//* empty css                 */import"./EditorWorker.vue_vue_type_script_setup_true_lang-44860150.js";import"./index-00ad513e.js";import"./index-bf1882c4.js";import de from"./index-3c0106d1.js";/* empty css                                                              */import{i as ie,d as ue,x as pe,n as G,k as O,p as me,w as ce}from"./elementPlus-07602b2b.js";import{d as z,r as _,f as F,o as g,s as k,w as a,a as s,a6 as D,c as V,h as I,u as c,i as fe,a7 as _e,g as T,N as ge,x as ve,F as we,ah as B,G as he,H as qe}from"./vue-65382a1b.js";import{_ as L}from"./xgplayerVue-c27b6911.js";import Pe from"./index-fd5e8240.js";import{t as ye}from"./index-55ccac47.js";import{l as De}from"./lodash-f91682a1.js";/* empty css                   */import"./vueRepl-a238c739.js";import"./vuema-115cb50e.js";/* empty css                         */import"./Close-095524a6.js";import"./SettingItem-0e9c370f.js";import"./index.vue_vue_type_script_setup_true_lang-12a93146.js";import"./editorWorker-7e4b3ef6.js";import"./hCode-f0cdea69.js";import"./highlight-87778b4e.js";import"./echarts-676dbcd6.js";const Ie={class:"go-pr-3"},Ce={key:1},Se=z({__name:"pondIndex",props:{modelShow:Boolean,targetDataRequest:Object},emits:["update:modelShow","editSaveHandle"],setup(t,{emit:o}){const n=t;_();const f=_(),q=_(!1);F(()=>n.modelShow,d=>{q.value=d});const v=()=>{o("update:modelShow",!1)},p=()=>{var d,u;if(!((d=n.targetDataRequest)!=null&&d.dataPondName)){window.$message.warning("请在左下角输入名称！"),(u=f.value)==null||u.focus();return}j({message:"保存内容将同步修改所有使用此接口的组件, 是否继续?",isMaskClosable:!0,transformOrigin:"center",onPositiveCallback:()=>{o("update:modelShow",!1),o("editSaveHandle",n.targetDataRequest)}})};return(d,u)=>{const P=ie,w=ue,h=pe,i=G,y=O,E=U;return g(),k(E,{title:"接口设置",class:"go-chart-data-request",modelValue:q.value,"onUpdate:modelValue":u[1]||(u[1]=m=>q.value=m),onClose:v},{footer:a(()=>[s(i,{justify:"space-between",style:{width:"100%","justify-content":"space-between"}},{default:a(()=>[t.targetDataRequest?(g(),k(i,{key:0},{default:a(()=>[s(w,{type:"success",size:"large"},{default:a(()=>[D("名称：")]),_:1}),s(h,{modelValue:t.targetDataRequest.dataPondName,"onUpdate:modelValue":u[0]||(u[0]=m=>t.targetDataRequest.dataPondName=m),ref_key:"inputInstRef",ref:f,type:"text",size:"small",autofocus:!0,clearable:!0,minlength:1,maxlength:16,placeholder:"请输入名称"},null,8,["modelValue"])]),_:1})):(g(),V("span",Ce)),s(i,null,{default:a(()=>[s(y,{onClick:v},{default:a(()=>[D("取消")]),_:1}),s(y,{type:"primary",onClick:p},{default:a(()=>[D("保存")]),_:1})]),_:1})]),_:1})]),default:a(()=>[s(P,{height:"640px","wrap-style":"padding:20px;"},{default:a(()=>{var m;return[I("div",Ie,[I("div",null,[s(c(re)),s(c(de),{"target-data-request":(m=t.targetDataRequest)==null?void 0:m.dataPondRequestConfig},null,8,["target-data-request"])])])]}),_:1})]),_:1},8,["modelValue"])}}});const xe=L(Se,[["__scopeId","data-v-7ee8f94c"]]),Re=t=>(he("data-v-f598ddff"),t=t(),qe(),t),be={class:"pond-content"},ke={key:1,class:"no-data go-flex-center"},Ee=["src"],Ve=Re(()=>I("span",null,"暂未选择公共接口",-1)),$e=z({__name:"index",props:{modelShow:{type:Boolean}},emits:["update:modelShow","sendHandle"],setup(t,{emit:o}){const n=t,f=fe("targetData"),{PencilIcon:q}=ne.ionicons5,{chartEditStore:v}=le(),{requestDataPond:p}=_e(v.getRequestGlobalConfig),d=_(!1),u=T({get(){return n.modelShow},set(e){o("update:modelShow",e)}}),P=_(!1),w=_(!1),h=_(),i=T(()=>{var r,C;const e=(C=(r=f==null?void 0:f.value)==null?void 0:r.request)==null?void 0:C.requestDataPondId;return e?p.value.filter(S=>e===S.dataPondId)[0]:void 0});F(()=>i.value,e=>{P.value=!0,h.value=e,ge(()=>{P.value=!1})},{immediate:!0});const y=(e=!1)=>{w.value=!!e,d.value=!0},E=()=>{const e=oe();h.value={dataPondId:e,dataPondName:e,dataPondRequestConfig:De.cloneDeep(b(R({},ye),{requestDataType:N.Pond}))},y()},m=e=>{w.value?M(e):A(e),w.value=!1,d.value=!1},M=e=>{try{const l=p.value.findIndex(r=>r.dataPondId===e.dataPondId);l!==-1?(p.value.splice(l,1,e),v.getComponentList.forEach(r=>{r.request.requestDataType===N.Pond&&r.request.requestDataPondId===e.dataPondId&&(r.request=b(R({},B(e.dataPondRequestConfig)),{requestDataPondId:e.dataPondId}))}),window.$message.success("保存成功！")):window.$message.error("编辑失败，请稍后重试！")}catch(l){window.$message.error("编辑失败，请稍后重试！")}},A=e=>{try{h.value?(p.value.unshift(e),window.$message.success("创建成功!")):window.$message.error("创建失败，请稍后重试!")}catch(l){window.$message.error("创建失败，请稍后重试!")}},J=e=>{j({message:"删除数据后，需手动处理使用改接口的组件，是否继续？",isMaskClosable:!0,transformOrigin:"center",onPositiveCallback:()=>{const l=p.value.findIndex(r=>r.dataPondId===e.dataPondId);l!==-1?(p.value.splice(l,1),window.$message.success("删除成功!")):window.$message.error("删除失败，请稍后重试！")}})},K=()=>{i.value&&(f.value.request=b(R({},B(i.value.dataPondRequestConfig)),{requestDataPondId:i.value.dataPondId})),o("update:modelShow",!1),o("sendHandle")};return(e,l)=>{const r=me,C=ce,S=O,Q=G,W=U;return g(),V(we,null,[s(W,{title:"公共接口配置",class:"go-chart-data-pond-control",modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=x=>u.value=x)},{footer:a(()=>[s(Q,{justify:"space-between"},{default:a(()=>[s(S,{type:"info",secondary:"",disabled:!i.value,onClick:l[0]||(l[0]=x=>y(!0))},{icon:a(()=>[s(C,null,{default:a(()=>[s(c(q))]),_:1})]),default:a(()=>[D(" 编辑内容 ")]),_:1},8,["disabled"]),s(S,{type:"primary",onClick:K},{default:a(()=>[D("保存 & 发送请求")]),_:1})]),_:1})]),default:a(()=>[s(r,{style:{height:"650px"}},{default:a(()=>[I("div",be,[i.value&&!P.value?(g(),k(c(Pe),{key:0,targetData:i.value,globalData:c(v).getRequestGlobalConfig},null,8,["targetData","globalData"])):(g(),V("div",ke,[I("img",{src:c(ae),alt:"暂无数据"},null,8,Ee),Ve])),s(c(se),{onCreatePond:E,onDeletePond:J})])]),_:1})]),_:1},8,["modelValue"]),d.value?(g(),k(c(xe),{key:0,modelShow:d.value,"onUpdate:modelShow":l[2]||(l[2]=x=>d.value=x),targetDataRequest:h.value,isEdit:w.value,onEditSaveHandle:m},null,8,["modelShow","targetDataRequest","isEdit"])):ve("",!0)],64)}}});const Mt=L($e,[["__scopeId","data-v-f598ddff"]]);export{Mt as default};
