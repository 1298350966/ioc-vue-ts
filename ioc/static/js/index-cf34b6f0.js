var F=(n,a,t)=>new Promise((r,v)=>{var D=i=>{try{l(t.next(i))}catch(_){v(_)}},p=i=>{try{l(t.throw(i))}catch(_){v(_)}},l=i=>i.done?r(i.value):Promise.resolve(i.value).then(D,p);l((t=t.apply(n,a)).next())});import{u as K,M as g,j as P,d as ee}from"./index-4e626338.js";/* empty css                 */import{D as j}from"./vuedraggable-26823587.js";import{L as $,b as q,d as te,u as oe,a as se,C as ne}from"./index-383f02b3.js";import{u as V}from"./chartEditStore-8641b951.js";/* empty css                        */import{d as A,aI as R,g as C,al as E,y as Y,z as W,o as d,c as z,a as M,w as H,s as L,m as b,r as B,h as y,l as X,u as m,f as ae,x as re}from"./vue-65382a1b.js";import{bq as le}from"./index-55ccac47.js";/* empty css                */import{w as J,aa as ie,ar as ce,S as ue}from"./elementPlus-07602b2b.js";import{_ as N}from"./xgplayerVue-c27b6911.js";import"./el-collapse-transition-4ed993c7.js";import"./vueRepl-a238c739.js";import"./lodash-f91682a1.js";import"./vuema-115cb50e.js";/* empty css                */import"./plugin-68db7aa1.js";import"./icon-24f36b03.js";import"./Close-095524a6.js";import"./views-99f1c264.js";import"./axios-ba46900f.js";import"./axios-e76ab20a.js";/* empty css                    *//* empty css                 *//* empty css                     *//* empty css                  *//* empty css                        *//* empty css                 */import"./el-tooltip-4ed993c7.js";/* empty css                  *//* empty css               *//* empty css                  */import"./style-2d240cf8.js";import"./fileTypeEnum-eae25d97.js";/* empty css                    *//* empty css                  */import"./echarts-676dbcd6.js";const de={class:"icon-item-box"},pe=A({__name:"index",props:{isGroup:{type:Boolean,default:!1},hover:{type:Boolean,default:!1},status:{type:Object,default:()=>({lock:!1,hide:!1})}},setup(n){const a=n;R(l=>({"621af972":v.value}));const t=V(),r=K(),v=C(()=>r.getAppTheme),D=l=>{l.stopPropagation(),a.status.hide?t.setShow():t.setHide()},p=l=>{l.stopPropagation(),a.status.lock?t.setUnLock():t.setLock()};return(l,i)=>{const _=E("Lock"),G=E("Unlock"),x=J,S=E("Hide"),w=E("View");return Y((d(),z("div",de,[M(x,{onClick:p,size:15,class:b(["icon-item",{active:n.status.lock}])},{default:H(()=>[n.status.lock?(d(),L(_,{key:0})):(d(),L(G,{key:1}))]),_:1},8,["class"]),M(x,{onClick:D,size:15,class:b(["icon-item",{active:n.status.hide}])},{default:H(()=>[n.status.hide?(d(),L(S,{key:0})):(d(),L(w,{key:1}))]),_:1},8,["class"]),M(x)],512)),[[W,!n.isGroup]])}}});const Q=N(pe,[["__scopeId","data-v-88893103"]]),me={class:"flex-center item-content"},ve={class:"list-text-ellipsis"},_e={class:"list-text"},he=A({name:"LayersListItem",__name:"index",props:{componentData:{type:Object,required:!0},isGroup:{type:Boolean,default:!1},layerMode:{type:String,default:$.THUMBNAIL}},setup(n){const a=n;R(x=>({"0dc6f472":p.value}));const t=K(),r=V(),v=B("");(()=>F(this,null,function*(){v.value=yield le(a.componentData.chartConfig)}))();const p=C(()=>t.getAppTheme),l=C(()=>{const x=a.componentData.id;return r.getTargetChart.selectId.find(S=>S===x)}),i=C(()=>a.componentData.id===r.getTargetChart.hoverId),_=C(()=>a.componentData.status),G=C(()=>a.layerMode===$.TEXT);return(x,S)=>{const w=ie;return d(),z("div",{class:b(["content-layers-list-item",{hover:i.value,select:l.value,"list-mini":G.value}])},[y("div",me,[M(w,{class:"list-img",src:v.value,fit:"contain"},null,8,["src"]),y("div",ve,[y("span",_e,X(a.componentData.chartConfig.title),1)]),M(m(Q),{isGroup:n.isGroup,hover:i.value,status:_.value},null,8,["isGroup","hover","status"])]),y("div",{class:b({"select-modal":l.value})},null,2)],2)}}});const Z=N(he,[["__scopeId","data-v-47e7e2dd"]]),fe={class:"content-layers-group-list-item"},ge={class:"kh-flex-items-center item-content"},ye={class:"list-text-ellipsis"},Ce={class:"list-text"},xe=A({__name:"index",props:{componentGroupData:{type:Object,required:!0},layerMode:{type:String,default:$.THUMBNAIL}},setup(n){const a=n;R(o=>({"5fff07b8":l.value})),g.UN_GROUP;const t=K(),r=V(),{handleContextMenu:v,onClickOutSide:D}=q(),p=B(!1),l=C(()=>t.getAppTheme),i=C(()=>a.layerMode===$.TEXT),_=C(()=>{const o=a.componentGroupData.id;return r.getTargetChart.selectId.find(e=>e===o)}),G=C(()=>a.componentGroupData.id===r.getTargetChart.hoverId),x=C(()=>a.componentGroupData.status),S=(o,e,T)=>{const I=k=>e.filter(O=>k.includes(O.key));if(r.getTargetChart.selectId.length>1)return I([g.GROUP]);{const k=[];return T.status.lock?k.push(g.LOCK):k.push(g.UNLOCK),T.status.hide?k.push(g.HIDE):k.push(g.SHOW),[...I([g.UN_GROUP]),te(),...o.filter(O=>!k.includes(O.key))]}},w=o=>{var e;(e=window.$KeyboardActive)!=null&&e.ctrl||(p.value=!p.value,h(o,a.componentGroupData))},c=o=>{var T;D();const e=a.componentGroupData.id;if(o.buttons===P.LEFT&&((T=window.$KeyboardActive)!=null&&T.ctrl)){if(r.targetChart.selectId.includes(e)){const I=r.targetChart.selectId.filter(k=>k!==e);r.setTargetSelectChart(I)}else r.setTargetSelectChart(e,!0);return}r.setTargetSelectChart(e)},h=(o,e,T)=>{console.log(e),D(),r.setTargetSelectChart(T||e.id)},f=o=>{r.setTargetHoverChart(o.id)},s=o=>{r.setTargetHoverChart(void 0)};return(o,e)=>{const T=E("Folder"),I=E("FolderOpened"),k=J,O=ce;return d(),z("div",fe,[y("div",{class:b(["root-item-content",{hover:G.value,select:_.value,"list-mini":i.value}]),onClick:e[0]||(e[0]=u=>w(u)),onMousedown:e[1]||(e[1]=u=>c(u)),onMouseenter:e[2]||(e[2]=u=>f(n.componentGroupData)),onMouseleave:e[3]||(e[3]=u=>s(n.componentGroupData)),onContextmenu:e[4]||(e[4]=u=>m(v)(u,n.componentGroupData,S))},[y("div",ge,[M(k,{size:20,style:{"vertical-align":"middle"}},{default:H(()=>[p.value?(d(),L(T,{key:0})):(d(),L(I,{key:1}))]),_:1}),y("div",ye,[y("span",Ce,X(n.componentGroupData.chartConfig.title),1)]),M(m(Q),{isGroup:!1,hover:G.value,status:x.value},null,8,["hover","status"])]),y("div",{class:b({"select-modal":_.value})},null,2)],34),M(O,null,{default:H(()=>[Y(y("div",null,[M(m(j),{group:"groupLAYER","item-key":"id",modelValue:n.componentGroupData.groupList,"onUpdate:modelValue":e[6]||(e[6]=u=>n.componentGroupData.groupList=u),ghostClass:"ghost"},{item:H(({element:u})=>[y("div",null,[(d(),L(m(Z),{key:u.id,componentData:u,"layer-mode":n.layerMode,isGroup:!0,onMousedown:U=>h(U,u),onMouseenter:U=>f(u),onMouseleave:U=>s(u),onContextmenu:e[5]||(e[5]=U=>m(v)(U,n.componentGroupData,S))},null,8,["componentData","layer-mode","onMousedown","onMouseenter","onMouseleave"]))])]),_:1},8,["modelValue"])],512),[[W,p.value]])]),_:1})])}}});const ke=N(xe,[["__scopeId","data-v-7eb2afb3"]]),Le={class:"kh-content-layer-box"},Me=A({__name:"index",setup(n){const a=oe(),t=V(),{handleContextMenu:r,onClickOutSide:v}=q(),D=B([]),p=B(a.getLayerType),l=C(()=>ee(t.getComponentList));ae(()=>l.value,c=>{D.value=c},{immediate:!0});const i=(c,h,f)=>{if(t.getTargetChart.selectId.length>1)return c.filter(o=>o.key===g.GROUP);const s=[];return f.status.lock?s.push(g.LOCK):s.push(g.UNLOCK),f.status.hide?s.push(g.HIDE):s.push(g.SHOW),c.filter(o=>!s.includes(o.key))},_=()=>{a.setItem(ne.LAYERS,!1)},G=c=>{const h=document.querySelector(".kh-content-layer-box");c.target.contains(h)&&t.setTargetSelectChart()},x=(c,h)=>{var s;v();const f=h.id;if(c.buttons===P.LEFT&&((s=window.$KeyboardActive)!=null&&s.ctrl)){if(t.targetChart.selectId.includes(f)){const o=t.targetChart.selectId.filter(e=>e!==f);t.setTargetSelectChart(o)}else t.setTargetSelectChart(f,!0);return}t.setTargetSelectChart(f)},S=c=>{t.setTargetHoverChart(c.id)},w=c=>{t.setTargetHoverChart(void 0)};return(c,h)=>{const f=ue;return d(),L(m(se),{class:"kh-content-layers",title:"图层",onMousedown:h[1]||(h[1]=s=>G(s)),onBack:_},{default:H(()=>[l.value.length===0?(d(),L(f,{key:0,class:"empty-box","image-size":100,description:"暂无图层"})):re("",!0),M(m(j),{group:"LAYER","item-key":"id",modelValue:m(t).componentList,"onUpdate:modelValue":h[0]||(h[0]=s=>m(t).componentList=s),ghostClass:"ghost"},{item:H(({element:s})=>[y("div",Le,[s.isGroup?(d(),L(m(ke),{key:0,componentGroupData:s,"layer-mode":p.value},null,8,["componentGroupData","layer-mode"])):(d(),L(m(Z),{key:1,componentData:s,"layer-mode":p.value,onMousedown:o=>x(o,s),onMouseenter:o=>S(s),onMouseleave:o=>w(s),onContextmenu:o=>m(r)(o,s,i)},null,8,["componentData","layer-mode","onMousedown","onMouseenter","onMouseleave","onContextmenu"]))])]),_:1},8,["modelValue"])]),_:1})}}});const ct=N(Me,[["__scopeId","data-v-37033f62"]]);export{ct as default};
