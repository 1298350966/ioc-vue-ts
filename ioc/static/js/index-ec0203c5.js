var E=Object.defineProperty,O=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var W=(s,i,r)=>i in s?E(s,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[i]=r,q=(s,i)=>{for(var r in i||(i={}))V.call(i,r)&&W(s,r,i[r]);if(M)for(var r of M(i))J.call(i,r)&&W(s,r,i[r]);return s},P=(s,i)=>O(s,U(i));var T=(s,i,r)=>new Promise((_,f)=>{var e=g=>{try{w(r.next(g))}catch(p){f(p)}},v=g=>{try{w(r.throw(g))}catch(p){f(p)}},w=g=>g.done?_(g.value):Promise.resolve(g.value).then(e,v);w((r=r.apply(s,i)).next())});import{d as K}from"./index-4e626338.js";import{u as Q}from"./useChartDataFetch.hook-495a5af9.js";import"./axios-ba46900f.js";import"./echarts-676dbcd6.js";import"./lodash-f91682a1.js";import{m as A}from"./index-55ccac47.js";import{d as X,i as Y,a7 as Z,b as ee,A as te,f as b,B as ne,o as m,c as u,n as x,F as D,q as G,x as j,u as ae}from"./vue-65382a1b.js";import{_ as ie}from"./xgplayerVue-c27b6911.js";import"./elementPlus-07602b2b.js";import"./vuema-115cb50e.js";import"./vueRepl-a238c739.js";import"./http-0d114cdb.js";import"./axios-e76ab20a.js";const oe={class:"dv-scroll-board"},re=["align","innerHTML"],se=["align","innerHTML"],le=X({__name:"index",props:{chartConfig:{type:Object,required:!0}},setup(s){const i=s,r=Y("rootConfig"),{w:_,h:f}=Z(i.chartConfig.attr),e=ee({defaultConfig:{header:[],dataset:[],rowNum:5,headerBGC:"#00BAFF",oddRowBGC:"#003B51",evenRowBGC:"#0A2732",waitTime:2,headerHeight:35,columnWidth:[],align:[],index:!1,indexHeader:"#",carousel:"single",hoverPause:!0},mergedConfig:i.chartConfig.option,header:[],rowsData:[],rows:[{ceils:[],rowIndex:0,scroll:0}],widths:[],heights:[0],avgHeight:0,aligns:[],animationIndex:0,animationHandler:0,updater:0,needCalc:!1}),v=()=>{w(),g(),p(),S(),N(),z(),L(!0)};te(()=>{v()});const w=()=>{e.mergedConfig=A(K(e.defaultConfig),i.chartConfig.option)},g=()=>{let{header:t,index:l,indexHeader:o}=e.mergedConfig;if(!t.length){e.header=[];return}t=[...t],l&&t.unshift(o),e.header=t},p=()=>{let{dataset:t,index:l,headerBGC:o,rowNum:n}=e.mergedConfig;l&&(t=t.map((a,c)=>{a=[...a];const h=`<span class="index" style="background-color: ${o};border-radius: 3px;padding: 0px 3px;">${c+1}</span>`;return a.unshift(h),a})),t=t.map((a,c)=>({ceils:a,rowIndex:c}));const d=t.length;d>n&&d<2*n&&(t=[...t,...t]),t=t.map((a,c)=>P(q({},a),{scroll:c})),e.rowsData=t,e.rows=t},S=()=>{const{mergedConfig:t,rowsData:l}=e,{columnWidth:o,header:n}=t,d=o.reduce((H,C)=>H+C,0);let a=0;l[0]?a=l[0].ceils.length:n.length&&(a=n.length);const c=(_.value-d)/(a-o.length),h=new Array(a).fill(c);e.widths=A(h,o)},N=(t=!1)=>{const{mergedConfig:l,header:o}=e,{headerHeight:n,rowNum:d,dataset:a}=l;let c=f.value;o.length&&(c-=n);const h=c/d;e.avgHeight=h,t||(e.heights=new Array(a.length).fill(h))},z=()=>{const{header:t,mergedConfig:l}=e,o=t.length;let n=new Array(o).fill("left");const{align:d}=l;e.aligns=A(n,d)},L=(t=!1)=>T(this,null,function*(){const{needCalc:l}=e;l&&(p(),N(),e.needCalc=!1);let{avgHeight:o,animationIndex:n,mergedConfig:d,rowsData:a,updater:c}=e;const{waitTime:h,carousel:H,rowNum:C}=d,$=a.length;if(C>=$||t&&(yield new Promise(k=>setTimeout(k,h*1e3)),c!==e.updater))return;const B=H==="single"?1:C;let I=a.slice(n);if(I.push(...a.slice(0,n)),e.rows=I.slice(0,H==="page"?C*2:C+1),e.heights=new Array($).fill(o),yield new Promise(k=>setTimeout(k,300)),c!==e.updater)return;e.heights.splice(0,B,...new Array(B).fill(0)),n+=B;const F=n-$;F>=0&&(n=F),e.animationIndex=n,e.animationHandler=setTimeout(L,h*1e3-300)}),R=()=>{e.updater=(e.updater+1)%999999,e.animationHandler&&clearTimeout(e.animationHandler)},y=()=>T(this,null,function*(){e.mergedConfig&&(R(),v())});return b(()=>_.value,()=>{y()}),b(()=>f.value,()=>{y()}),b(()=>i.chartConfig.option,()=>{y()},{deep:!0}),Q(i.chartConfig,r.requestGlobalConfig,t=>{i.chartConfig.option.dataset=t,y()}),ne(()=>{R()}),(t,l)=>(m(),u("div",oe,[e.header.length&&e.mergedConfig?(m(),u("div",{key:0,class:"header",style:x(`background-color: ${e.mergedConfig.headerBGC};`)},[(m(!0),u(D,null,G(e.header,(o,n)=>(m(),u("div",{class:"header-item",key:`${o}${n}`,style:x(`
        height: ${e.mergedConfig.headerHeight}px;
        line-height: ${e.mergedConfig.headerHeight}px;
        width: ${e.widths[n]}px;
      `),align:e.aligns[n],innerHTML:o},null,12,re))),128))],4)):j("",!0),e.mergedConfig?(m(),u("div",{key:1,class:"rows",style:x(`height: ${ae(f)-(e.header.length?e.mergedConfig.headerHeight:0)}px;`)},[(m(!0),u(D,null,G(e.rows,(o,n)=>(m(),u("div",{class:"row-item",key:`${o.toString()}${o.scroll}`,style:x(`
        height: ${e.heights[n]}px;
        line-height: ${e.heights[n]}px;
        background-color: ${e.mergedConfig[o.rowIndex%2===0?"evenRowBGC":"oddRowBGC"]};
      `)},[(m(!0),u(D,null,G(o.ceils,(d,a)=>(m(),u("div",{class:"ceil",key:`${d}${n}${a}`,style:x(`width: ${e.widths[a]}px;`),align:e.aligns[a],innerHTML:d},null,12,se))),128))],4))),128))],4)):j("",!0)]))}});const He=ie(le,[["__scopeId","data-v-d0af9a4d"]]);export{He as default};
